import{a as e,b as a,dC as n,p as l,U as t,r,R as i,w as o,e as s,o as u,i as d,k as c,l as p,D as v,q as m,f,h as y,z as x,F as g,x as h,e9 as C}from"./index.js";const b=a({name:"ArrayForm",components:{BasicForm:n},props:{card:l.object.isRequired.type,form:l.object.isRequired.type,value:l.array.def((()=>[]))},emits:["redo","submit"],setup(e,{emit:a}){const{prefixCls:n}=t("array-form"),{createMessage:l}=C(),s=r(e.value),u=i((()=>{var a,n;return null!=(n=null==(a=e.card)?void 0:a.addBtnText)?n:"新增"}));function d(){return e=this,a=null,n=function*(){return s.value.filter((e=>!(null==e||""==e)))},new Promise(((l,t)=>{var r=e=>{try{o(n.next(e))}catch(a){t(a)}},i=e=>{try{o(n.throw(e))}catch(a){t(a)}},o=e=>e.done?l(e.value):Promise.resolve(e.value).then(r,i);o((n=n.apply(e,a)).next())}));var e,a,n}return o((()=>e.value),(()=>s.value=e.value)),{emit:a,prefixCls:n,innerValue:s,addBtnText:u,onAdd:function(){var a;let n=null==(a=e.card)?void 0:a.lengthMax;null!=n&&s.value.length>=n?l.warn(`最多只能添加${n}个`):s.value.push("")},onRemove:function(a){var n;let t=null==(n=e.card)?void 0:n.lengthMin;null!=t&&s.value.length<=t?l.warn(`至少要留${t}个`):s.value.splice(a,1)},onSubmit:function(){var n;(null==(n=e.form)?void 0:n.actions)||(e.form.actions={validate:d}),a("submit",e.form)}}}}),k={style:{color:"#333333"}},w={class:"array-box"},_={class:"array-item"},R={style:{"text-align":"center"}},A=v("span",null,"保存",-1);var B=e(b,[["render",function(e,a,n,l,t,r){const i=s("icon"),o=s("a-tooltip"),C=s("a-input"),b=s("a-button"),B=s("a-popconfirm"),V=s("a-spin"),j=s("a-card");return u(),d(j,{title:e.card.title,class:h([e.prefixCls]),bordered:!1},{extra:c((()=>[p(o,{title:"刷新"},{default:c((()=>[p(i,{icon:"ant-design:redo",style:{cursor:"pointer"},onClick:a[0]||(a[0]=()=>e.emit("redo",e.form))})])),_:1})])),default:c((()=>[p(V,{spinning:e.form.loading},{default:c((()=>[v("div",k,m(e.card.desc),1),v("div",w,[(u(!0),f(g,null,y(e.innerValue,((a,n)=>(u(),f("div",_,[p(C,{value:e.innerValue[n],"onUpdate:value":a=>e.innerValue[n]=a,style:{"max-width":"880px"}},null,8,["value","onUpdate:value"]),e.card.allowDel?(u(),d(B,{key:0,title:"确定要删除吗？",onConfirm:()=>e.onRemove(n)},{default:c((()=>[p(b,{type:"primary","pre-icon":"ant-design:minus",size:"small",shape:"circle",danger:""})])),_:2},1032,["onConfirm"])):x("",!0)])))),256)),e.card.allowAdd?(u(),d(b,{key:0,type:"link","pre-icon":"ant-design:plus",size:"small",onClick:e.onAdd},{default:c((()=>[v("span",null,m(e.addBtnText),1)])),_:1},8,["onClick"])):x("",!0)]),v("div",R,[p(b,{type:"primary","pre-icon":"ant-design:save",onClick:e.onSubmit},{default:c((()=>[A])),_:1},8,["onClick"])])])),_:1},8,["spinning"])])),_:1},8,["title","class"])}]]);export{B as default};
