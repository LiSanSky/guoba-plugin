var e=Object.defineProperty,r=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,n=(r,a,t)=>a in r?e(r,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[a]=t;import{a as i,b as d,dC as s,p as c,U as u,r as f,R as p,e as m,o as y,i as v,k as C,D as b,q as g,f as k,z as w,l as x,F,x as O,u as j}from"./index.js";const P=d({name:"CardForm",components:{BasicForm:s},props:{card:c.object.isRequired.type,form:c.object.isRequired.type,isDefault:c.bool.def(!1),allowFold:c.bool.def(!1),defaultFold:c.bool.def(!1)},emits:["redo","submit","addCard","delCard"],setup(e,{emit:i}){const{createPrompt:d}=j(),{prefixCls:s}=u("card-form"),c=f(!!e.defaultFold),m=p((()=>{return r=e.card,a=e.form,r.title.replace(/{{([^}]+)}}/g,((e,t)=>new Function("card","form",`return ${t}`)(r,a)));var r,a})),y=p((()=>{var r,a;return null!=(a=null==(r=e.card)?void 0:r.addBtnText)?a:"新增"}));return{emit:i,prefixCls:s,folded:c,cardTitle:m,addBtnText:y,onClickTitle:function(){e.allowFold&&(c.value=!c.value)},onAddCard:function(){var s,c;d((c=((e,r)=>{for(var a in r||(r={}))o.call(r,a)&&n(e,a,r[a]);if(t)for(var a of t(r))l.call(r,a)&&n(e,a,r[a]);return e})({title:y.value,required:!0},null==(s=e.card)?void 0:s.promptProps),r(c,a({onOk(r){return a=this,t=null,o=function*(){i("addCard",{form:e.form,key:r})},new Promise(((e,r)=>{var l=e=>{try{i(o.next(e))}catch(a){r(a)}},n=e=>{try{i(o.throw(e))}catch(a){r(a)}},i=r=>r.done?e(r.value):Promise.resolve(r.value).then(l,n);i((o=o.apply(a,t)).next())}));var a,t,o}}))))},onRemoveCard:function(){i("delCard",{form:e.form})}}}}),T={key:0,style:{"margin-left":"8px"}},R={style:{"text-align":"center"}},_=b("span",null,"保存",-1),h=b("span",null,"删除当前配置",-1);var B=i(P,[["render",function(e,r,a,t,o,l){const n=m("icon"),i=m("a-tooltip"),d=m("BasicForm"),s=m("a-button"),c=m("a-divider"),u=m("a-popconfirm"),f=m("a-spin"),p=m("a-card");return y(),v(p,{class:O([e.prefixCls,{"allow-fold":e.allowFold,folded:e.folded}]),bordered:!1},{title:C((()=>[b("div",{class:"card-title",onClick:r[0]||(r[0]=(...r)=>e.onClickTitle&&e.onClickTitle(...r))},[b("span",null,g(e.cardTitle),1),e.allowFold?(y(),k("span",T,[e.folded?(y(),v(n,{key:0,icon:"ant-design:caret-down"})):(y(),v(n,{key:1,icon:"ant-design:caret-up"}))])):w("",!0)])])),extra:C((()=>[x(i,{title:"刷新"},{default:C((()=>[x(n,{icon:"ant-design:redo",style:{cursor:"pointer"},onClick:r[1]||(r[1]=()=>e.emit("redo",e.form))})])),_:1})])),default:C((()=>[x(f,{spinning:e.form.loading},{default:C((()=>[x(d,{onRegister:e.form.register},null,8,["onRegister"]),b("div",R,[x(s,{type:"primary","pre-icon":"ant-design:save",onClick:r[2]||(r[2]=()=>e.emit("submit",e.form))},{default:C((()=>[_])),_:1}),e.isDefault?(y(),k(F,{key:0},[x(c,{type:"vertical"}),e.card.allowAdd?(y(),v(s,{key:0,"pre-icon":"ant-design:plus",onClick:e.onAddCard},{default:C((()=>[b("span",null,g(e.addBtnText),1)])),_:1},8,["onClick"])):w("",!0)],64)):(y(),k(F,{key:1},[x(c,{type:"vertical"}),x(u,{title:"确定要删除当前配置吗？",onConfirm:e.onRemoveCard},{default:C((()=>[e.card.allowDel?(y(),v(s,{key:0,"pre-icon":"ant-design:minus",danger:""},{default:C((()=>[h])),_:1})):w("",!0)])),_:1},8,["onConfirm"])],64))])])),_:1},8,["spinning"])])),_:1},8,["class"])}]]);export{B as default};
