import{a as l,b as e,bK as a,r as t,fT as s,w as i,al as o,v as d,aX as n,e as c,o as u,f as r,k as m,j as p,z as v,i as f,d5 as h,c4 as g,x as D,bO as x,bN as y,M as b,e3 as k,F as w,l as I,cV as L,cW as C}from"./index.js";import{S as _}from"./index5.js";import j from"./SelectIconModal.js";import"./IconUploader.js";import"./esm.js";const B=l=>(L("data-v-45a35bad"),l=l(),C(),l),U=[I(" 编辑内容 "),B((()=>v("span",{class:"tip"},"按住这里可拖动",-1)))],M={class:"p-4"},z={class:"row"},R=B((()=>v("div",null,"分组",-1))),A={class:"flex-1"},E={class:"row"},N=B((()=>v("div",null,"仅主人",-1))),O={class:"flex justify-between align-center flex-wrap"},S={class:"flex justify-start"},V={class:"flex flex-1 justify-end"},$=I("添加项目"),T=I("添加分组"),F=I("删除该组"),K={key:0},P={class:"row"},W=B((()=>v("div",null,"标题",-1))),X={class:"flex-1"},q={class:"row"},G=B((()=>v("div",null,"描述",-1))),H={class:"flex-1"},J={class:"flex justify-between align-center"},Q={class:"flex justify-start"},Y={class:"flex flex-1 justify-end"},Z=I("添加项目"),ll=I("删除该项");var el=l(e({__name:"EditBodyModal",props:{panelCls:String,helpList:Object,modelData:Object,iconB64List:Array},setup(l){const e=l,{prefixCls:I}=a("miao-plugin-edit-modal"),L=t(!1);let C=!1;const B=()=>{let l=e.modelData.groupIndex;e.helpList.splice(l,0,{group:"未命名分组",list:[]}),e.modelData.group=e.helpList[l],e.modelData.cellIndex=e.modelData.cell=null},el=()=>{var l;let a=e.helpList[e.modelData.groupIndex];Array.isArray(a.list)||(a.list=[]);let t=null!=(l=e.modelData.cellIndex)?l:0;a.list.splice(t,0,{icon:1,title:"未命名项目",desc:"请添加描述"}),e.modelData.cell=a.list[t],e.modelData.cellIndex=t},al=l=>{let a,t=e.helpList,s=e.modelData.groupIndex;a=t[s],t[s]=t[s+l],t[s+l]=a,e.modelData.groupIndex+=l},tl=l=>{let a,t=e.helpList[e.modelData.groupIndex].list,s=e.modelData.cellIndex;a=t[s],t[s]=t[s+l],t[s+l]=a,e.modelData.cellIndex+=l},sl=()=>{e.helpList.splice(e.modelData.groupIndex,1),e.modelData.show=!1},il=()=>{let l=e.helpList[e.modelData.groupIndex],a=e.modelData.cellIndex;if(l.list.splice(a,1),0==l.list.length)e.modelData.cell=null,e.modelData.cellIndex=null;else{let t=a;t>=l.list.length&&(t=l.list.length-1),e.modelData.cell=l.list[t],e.modelData.cellIndex=t}},ol=()=>{L.value=!0,C=!0},dl=t(null),{x:nl,y:cl,isDragging:ul}=s(dl),rl=t(0),ml=t(0),pl=t(!1),vl=t(0),fl=t(0),hl=t(0),gl=t(0),Dl=t({left:0,right:0,top:0,bottom:0});i([nl,cl],(()=>{if(!pl.value){rl.value=nl.value,ml.value=cl.value;const l=document.body.getBoundingClientRect(),e=dl.value.getBoundingClientRect();Dl.value.right=l.width-e.width,Dl.value.bottom=l.height-e.height,hl.value=vl.value,gl.value=fl.value}pl.value=!0})),i(ul,(()=>{ul||(pl.value=!1)})),o((()=>{pl.value&&(vl.value=hl.value+Math.min(Math.max(Dl.value.left,nl.value),Dl.value.right)-rl.value,fl.value=gl.value+Math.min(Math.max(Dl.value.top,cl.value),Dl.value.bottom)-ml.value)}));const xl=d((()=>({transform:`translate(${vl.value}px, ${fl.value}px)`})));function yl(l){var a,t,s;if(null==(a=e.modelData)?void 0:a.show){if(C)return;let a=l.composedPath();for(let l of a)if((null==(t=l.classList)?void 0:t.contains(I))||(null==(s=l.classList)?void 0:s.contains(e.panelCls)))return;e.modelData.show=!1}}function bl(){C=!1}return window.addEventListener("click",yl),n((()=>{window.removeEventListener("click",yl)})),(e,a)=>{const t=c("a-input"),s=c("Icon"),i=c("a-button"),o=c("a-popconfirm"),d=c("a-divider");return u(),r(w,null,[m(D(b),{visible:l.modelData.show,"onUpdate:visible":a[8]||(a[8]=e=>l.modelData.show=e),footer:null,mask:!1,class:y(D(I)),wrapClassName:"model-event-none"},{title:p((()=>[v("div",{ref_key:"modalTitleRef",ref:dl,style:{width:"100%",cursor:"move",margin:"0"}},U,512)])),modalRender:p((({originVNode:l})=>[v("div",{style:g(D(xl))},[(u(),f(h(l)))],4)])),default:p((()=>[v("div",M,[v("div",z,[R,v("div",A,[m(t,{value:l.modelData.group.group,"onUpdate:value":a[0]||(a[0]=e=>l.modelData.group.group=e),placeholder:"分组"},null,8,["value"])])]),v("div",E,[N,m(D(_),{checked:l.modelData.group.auth,"onUpdate:checked":a[1]||(a[1]=e=>l.modelData.group.auth=e),checkedValue:"master","checked-children":"是","un-checked-children":"否"},null,8,["checked"])]),v("div",O,[v("div",S,[m(i,{class:"ml-4",disabled:0===l.modelData.groupIndex,type:"primary",shape:"circle",size:"medium",onClick:a[2]||(a[2]=l=>al(-1))},{default:p((()=>[m(s,{icon:"akar-icons:arrow-up"})])),_:1},8,["disabled"]),m(i,{class:"ml-4",disabled:l.modelData.groupIndex===l.helpList.length-1,type:"primary",shape:"circle",size:"medium",onClick:a[3]||(a[3]=l=>al(1))},{default:p((()=>[m(s,{icon:"akar-icons:arrow-down"})])),_:1},8,["disabled"])]),v("div",V,[l.modelData.cell?x("",!0):(u(),f(i,{key:0,class:"ml-4",onClick:el},{default:p((()=>[$])),_:1})),m(i,{class:"ml-4",type:"success",onClick:B},{default:p((()=>[T])),_:1}),m(o,{title:"确定删除？",onConfirm:sl},{default:p((()=>[m(i,{class:"ml-4",type:"default",danger:""},{default:p((()=>[F])),_:1})])),_:1})])]),l.modelData.cell?(u(),r("div",K,[m(d,{style:{margin:"16px 0"}}),v("div",{class:"icon",onClick:ol,style:g(`background: url(${l.iconB64List[l.modelData.cell.icon]}) 0 0 no-repeat`)},null,4),v("div",P,[W,v("div",X,[m(t,{value:l.modelData.cell.title,"onUpdate:value":a[4]||(a[4]=e=>l.modelData.cell.title=e),placeholder:"标题"},null,8,["value"])])]),v("div",q,[G,v("div",H,[m(t,{value:l.modelData.cell.desc,"onUpdate:value":a[5]||(a[5]=e=>l.modelData.cell.desc=e),placeholder:"描述"},null,8,["value"])])]),v("div",J,[v("div",Q,[m(i,{class:"ml-4",disabled:0===l.modelData.cellIndex,type:"primary",shape:"circle",size:"medium",onClick:a[6]||(a[6]=l=>tl(-1))},{default:p((()=>[m(s,{icon:"akar-icons:arrow-left"})])),_:1},8,["disabled"]),m(i,{class:"ml-4",disabled:l.modelData.cellIndex===l.helpList[l.modelData.groupIndex].list.length-1,type:"primary",shape:"circle",size:"medium",onClick:a[7]||(a[7]=l=>tl(1))},{default:p((()=>[m(s,{icon:"akar-icons:arrow-right"})])),_:1},8,["disabled"])]),v("div",Y,[m(i,{class:"ml-4",type:"success",onClick:el},{default:p((()=>[Z])),_:1}),m(o,{title:"确定删除？",onConfirm:il},{default:p((()=>[m(i,{class:"ml-4",type:"default",danger:""},{default:p((()=>[ll])),_:1})])),_:1})])])])):x("",!0)])])),_:1},8,["visible","class"]),l.modelData.cell?(u(),f(j,{key:0,visible:L.value,"onUpdate:visible":a[9]||(a[9]=l=>L.value=l),cell:l.modelData.cell,"onUpdate:cell":a[10]||(a[10]=e=>l.modelData.cell=e),iconB64List:l.iconB64List,"onUpdate:iconB64List":a[11]||(a[11]=l=>k(iconB64List)?iconB64List.value=l:null),afterClose:bl},null,8,["visible","cell","iconB64List"])):x("",!0)],64)}}}),[["__scopeId","data-v-45a35bad"]]);export{el as default};
