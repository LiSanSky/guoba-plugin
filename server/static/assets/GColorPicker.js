import{c$ as e,a,o as t,f as l,Y as s,d0 as n,z as o,m as i,c4 as r,bN as h,e as c,k as u,i as d,bO as v,Z as g,b as p,bK as m,c as b,v as f,bf as C,w,x,j as y,d1 as k}from"./index.js";import{t as $}from"./throttle.js";function L(a,t){var l,s=a&&a.a;!(l=a&&a.hsl?e(a.hsl):a&&a.hex&&a.hex.length>0?e(a.hex):a&&a.hsv?e(a.hsv):a&&a.rgba?e(a.rgba):a&&a.rgb?e(a.rgb):e(a))||void 0!==l._a&&null!==l._a||l.setAlpha(s||1);var n=l.toHsl(),o=l.toHsv();return 0===n.s&&(o.h=n.h=a.h||a.hsl&&a.hsl.h||t||0),{hsl:n,hex:l.toHexString().toUpperCase(),hex8:l.toHex8String().toUpperCase(),rgba:l.toRgb(),hsv:o,oldHue:a.h||t||n.h,source:a.source,a:a.a||l.getAlpha()}}var D={props:["value"],data(){return{val:L(this.value)}},computed:{colors:{get(){return this.val},set(e){this.val=e,this.$emit("input",e)}}},watch:{value(e){this.val=L(e)}},methods:{colorChange(e,a){this.oldHue=this.colors.hsl.h,this.colors=L(e,a||this.oldHue)},isValidHex:a=>e(a).isValid(),simpleCheckForValidColor(e){for(var a=["r","g","b","a","h","s","l","v"],t=0,l=0,s=0;s<a.length;s++){var n=a[s];e[n]&&(t++,isNaN(e[n])||l++)}if(t===l)return e},paletteUpperCase:e=>e.map((e=>e.toUpperCase())),isTransparent:a=>0===e(a).getAlpha()}};const M={class:"vc-editable-input"},E=["aria-labelledby"],S=["for","id"],_={class:"vc-input__desc"};var H=a({name:"editableInput",props:{label:String,labelText:String,desc:String,value:[String,Number],max:Number,min:Number,arrowOffset:{type:Number,default:1}},computed:{val:{get(){return this.value},set(e){if(void 0===this.max)return e;+e>this.max?this.$refs.input.value=this.max:+e<this.min&&(this.$refs.input.value=this.min)}},labelId(){return`input__label__${this.label}__${Math.random().toString().slice(2,5)}`},labelSpanText(){return this.labelText||this.label}},methods:{update(e){this.handleChange(e.target.value)},handleChange(e){let a={};a[this.label]=e,(void 0===a.hex&&void 0===a["#"]||e.length>5)&&this.$emit("change",a)},handleKeyDown(e){let a=this.val,t=Number(a);if(t){let l=this.arrowOffset||1;38===e.keyCode&&(a=t+l,this.handleChange(a),e.preventDefault()),40===e.keyCode&&(a=t-l,this.handleChange(a),e.preventDefault())}}}},[["render",function(e,a,r,h,c,u){return t(),l("div",M,[s(o("input",{"aria-labelledby":u.labelId,class:"vc-input__input","onUpdate:modelValue":a[0]||(a[0]=e=>u.val=e),onKeydown:a[1]||(a[1]=(...e)=>u.handleKeyDown&&u.handleKeyDown(...e)),onInput:a[2]||(a[2]=(...e)=>u.update&&u.update(...e)),ref:"input"},null,40,E),[[n,u.val]]),o("span",{for:r.label,class:"vc-input__label",id:u.labelId},i(u.labelSpanText),9,S),o("span",_,i(r.desc),1)])}]]),U=function(e,a,t){return a<t?e<a?a:e>t?t:e:e<t?t:e>a?a:e};const T={name:"Saturation",props:{value:Object},computed:{colors(){return this.value},bgColor(){return`hsl(${this.colors.hsv.h}, 100%, 50%)`},pointerTop(){return-100*this.colors.hsv.v+1+100+"%"},pointerLeft(){return 100*this.colors.hsv.s+"%"}},methods:{throttle:$(((e,a)=>{e(a)}),20,{leading:!0,trailing:!1}),handleChange(e,a){!a&&e.preventDefault();var t=this.$refs.container;if(t){var l=t.clientWidth,s=t.clientHeight,n=t.getBoundingClientRect().left+window.pageXOffset,o=t.getBoundingClientRect().top+window.pageYOffset,i=e.pageX||(e.touches?e.touches[0].pageX:0),r=e.pageY||(e.touches?e.touches[0].pageY:0),h=U(i-n,0,l),c=U(r-o,0,s),u=h/l,d=U(-c/s+1,0,1);this.throttle(this.onChange,{h:this.colors.hsv.h,s:u,v:d,a:this.colors.hsv.a,source:"hsva"})}},onChange(e){this.$emit("change",e)},handleMouseDown(e){window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp(e){this.unbindEventListeners()},unbindEventListeners(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}},N=o("div",{class:"vc-saturation--white"},null,-1),O=o("div",{class:"vc-saturation--black"},null,-1),I=[o("div",{class:"vc-saturation-circle"},null,-1)];var A=a(T,[["render",function(e,a,s,n,i,h){return t(),l("div",{class:"vc-saturation",style:r({background:h.bgColor}),ref:"container",onMousedown:a[0]||(a[0]=(...e)=>h.handleMouseDown&&h.handleMouseDown(...e)),onTouchmove:a[1]||(a[1]=(...e)=>h.handleChange&&h.handleChange(...e)),onTouchstart:a[2]||(a[2]=(...e)=>h.handleChange&&h.handleChange(...e))},[N,O,o("div",{class:"vc-saturation-pointer",style:r({top:h.pointerTop,left:h.pointerLeft})},I,4)],36)}]]);const R={name:"Hue",props:{value:Object,direction:{type:String,default:"horizontal"}},data:()=>({oldHue:0,pullDirection:""}),computed:{colors(){const e=this.value.hsl.h;return 0!==e&&e-this.oldHue>0&&(this.pullDirection="right"),0!==e&&e-this.oldHue<0&&(this.pullDirection="left"),this.oldHue=e,this.value},directionClass(){return{"vc-hue--horizontal":"horizontal"===this.direction,"vc-hue--vertical":"vertical"===this.direction}},pointerTop(){return"vertical"===this.direction?0===this.colors.hsl.h&&"right"===this.pullDirection?0:-100*this.colors.hsl.h/360+100+"%":0},pointerLeft(){return"vertical"===this.direction?0:0===this.colors.hsl.h&&"right"===this.pullDirection?"100%":100*this.colors.hsl.h/360+"%"}},methods:{handleChange(e,a){!a&&e.preventDefault();var t=this.$refs.container;if(t){var l,s=t.clientWidth,n=t.clientHeight,o=t.getBoundingClientRect().left+window.pageXOffset,i=t.getBoundingClientRect().top+window.pageYOffset,r=(e.pageX||(e.touches?e.touches[0].pageX:0))-o,h=(e.pageY||(e.touches?e.touches[0].pageY:0))-i;"vertical"===this.direction?(l=h<0?360:h>n?0:360*(-100*h/n+100)/100,this.colors.hsl.h!==l&&this.$emit("change",{h:l,s:this.colors.hsl.s,l:this.colors.hsl.l,a:this.colors.hsl.a,source:"hsl"})):(l=r<0?0:r>s?360:360*(100*r/s)/100,this.colors.hsl.h!==l&&this.$emit("change",{h:l,s:this.colors.hsl.s,l:this.colors.hsl.l,a:this.colors.hsl.a,source:"hsl"}))}},handleMouseDown(e){this.handleChange(e,!0),window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp(e){this.unbindEventListeners()},unbindEventListeners(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}},j=["aria-valuenow"],B=[o("div",{class:"vc-hue-picker"},null,-1)];var F=a(R,[["render",function(e,a,s,n,i,c){return t(),l("div",{class:h(["vc-hue",c.directionClass])},[o("div",{class:"vc-hue-container",role:"slider","aria-valuenow":c.colors.hsl.h,"aria-valuemin":"0","aria-valuemax":"360",ref:"container",onMousedown:a[0]||(a[0]=(...e)=>c.handleMouseDown&&c.handleMouseDown(...e)),onTouchmove:a[1]||(a[1]=(...e)=>c.handleChange&&c.handleChange(...e)),onTouchstart:a[2]||(a[2]=(...e)=>c.handleChange&&c.handleChange(...e))},[o("div",{class:"vc-hue-pointer",style:r({top:c.pointerTop,left:c.pointerLeft}),role:"presentation"},B,4)],40,j)],2)}]]);let X={};function Y(e,a,t){var l=e+","+a+","+t;if(X[l])return X[l];var s=function(e,a,t){if("undefined"==typeof document)return null;var l=document.createElement("canvas");l.width=l.height=2*t;var s=l.getContext("2d");return s?(s.fillStyle=e,s.fillRect(0,0,l.width,l.height),s.fillStyle=a,s.fillRect(0,0,t,t),s.translate(t,t),s.fillRect(0,0,t,t),l.toDataURL()):null}(e,a,t);return X[l]=s,s}var z=a({name:"Checkboard",props:{size:{type:[Number,String],default:8},white:{type:String,default:"#fff"},grey:{type:String,default:"#e6e6e6"}},computed:{bgStyle(){return{"background-image":"url("+Y(this.white,this.grey,this.size)+")"}}}},[["render",function(e,a,s,n,o,i){return t(),l("div",{class:"vc-checkerboard",style:r(i.bgStyle)},null,4)}]]);const K={name:"Alpha",props:{value:Object,onChange:Function},components:{checkboard:z},computed:{colors(){return this.value},gradientColor(){var e=this.colors.rgba,a=[e.r,e.g,e.b].join(",");return"linear-gradient(to right, rgba("+a+", 0) 0%, rgba("+a+", 1) 100%)"}},methods:{handleChange(e,a){!a&&e.preventDefault();var t=this.$refs.container;if(t){var l,s=t.clientWidth,n=t.getBoundingClientRect().left+window.pageXOffset,o=(e.pageX||(e.touches?e.touches[0].pageX:0))-n;l=o<0?0:o>s?1:Math.round(100*o/s)/100,this.colors.a!==l&&this.$emit("change",{h:this.colors.hsl.h,s:this.colors.hsl.s,l:this.colors.hsl.l,a:l,source:"rgba"})}},handleMouseDown(e){this.handleChange(e,!0),window.addEventListener("mousemove",this.handleChange),window.addEventListener("mouseup",this.handleMouseUp)},handleMouseUp(){this.unbindEventListeners()},unbindEventListeners(){window.removeEventListener("mousemove",this.handleChange),window.removeEventListener("mouseup",this.handleMouseUp)}}},V={class:"vc-alpha"},P={class:"vc-alpha-checkboard-wrap"},W=[o("div",{class:"vc-alpha-picker"},null,-1)];var G=a(K,[["render",function(e,a,s,n,i,h){const d=c("checkboard");return t(),l("div",V,[o("div",P,[u(d)]),o("div",{class:"vc-alpha-gradient",style:r({background:h.gradientColor})},null,4),o("div",{class:"vc-alpha-container",ref:"container",onMousedown:a[0]||(a[0]=(...e)=>h.handleMouseDown&&h.handleMouseDown(...e)),onTouchmove:a[1]||(a[1]=(...e)=>h.handleChange&&h.handleChange(...e)),onTouchstart:a[2]||(a[2]=(...e)=>h.handleChange&&h.handleChange(...e))},[o("div",{class:"vc-alpha-pointer",style:r({left:100*h.colors.a+"%"})},W,4)],544)])}]]);const Z={name:"Chrome",mixins:[D],props:{disableAlpha:{type:Boolean,default:!1},disableFields:{type:Boolean,default:!1}},components:{saturation:A,hue:F,alpha:G,"ed-in":H,CheckBoard:z},data:()=>({fieldsIndex:1,highlight:!1}),computed:{hsl(){const{h:e,s:a,l:t}=this.colors.hsl;return{h:e.toFixed(),s:`${(100*a).toFixed()}%`,l:`${(100*t).toFixed()}%`}},activeColor(){const e=this.colors.rgba;return"rgba("+[e.r,e.g,e.b,e.a].join(",")+")"},hasAlpha(){return this.colors.a<1}},methods:{childChange(e){this.colorChange(e)},inputChange(e){if(e)if(e.hex)this.isValidHex(e.hex)&&this.colorChange({hex:e.hex,source:"hex"});else if(e.r||e.g||e.b||e.a)this.colorChange({r:e.r||this.colors.rgba.r,g:e.g||this.colors.rgba.g,b:e.b||this.colors.rgba.b,a:e.a||this.colors.rgba.a,source:"rgba"});else if(e.h||e.s||e.l){const a=e.s?e.s.replace("%","")/100:this.colors.hsl.s,t=e.l?e.l.replace("%","")/100:this.colors.hsl.l;this.colorChange({h:e.h||this.colors.hsl.h,s:a,l:t,source:"hsl"})}},showHighlight(){this.highlight=!0},hideHighlight(){this.highlight=!1}}},q={class:"vc-chrome-saturation-wrap"},J={class:"vc-chrome-body"},Q={class:"vc-chrome-controls"},ee={class:"vc-chrome-color-wrap"},ae=["aria-label"],te={class:"vc-chrome-sliders"},le={class:"vc-chrome-hue-wrap"},se={key:0,class:"vc-chrome-alpha-wrap"},ne={key:0,class:"vc-chrome-fields-wrap"},oe={class:"vc-chrome-fields"},ie={class:"vc-chrome-field"},re={class:"vc-chrome-field"},he={class:"vc-chrome-field"},ce={key:0,class:"vc-chrome-field"};var ue=a(Z,[["render",function(e,a,n,i,p,m){const b=c("saturation"),f=c("CheckBoard"),C=c("hue"),w=c("alpha"),x=c("ed-in");return t(),l("div",{role:"application","aria-label":"Chrome color picker",class:h(["vc-chrome",n.disableAlpha?"vc-chrome__disable-alpha":""])},[o("div",q,[u(b,{value:e.colors,"onUpdate:value":a[0]||(a[0]=a=>e.colors=a),onChange:m.childChange},null,8,["value","onChange"])]),o("div",J,[o("div",Q,[o("div",ee,[o("div",{"aria-label":`current color is ${e.colors.hex}`,class:"vc-chrome-active-color",style:r({background:m.activeColor})},null,12,ae),n.disableAlpha?v("",!0):(t(),d(f,{key:0}))]),o("div",te,[o("div",le,[u(C,{value:e.colors,"onUpdate:value":a[1]||(a[1]=a=>e.colors=a),onChange:m.childChange},null,8,["value","onChange"])]),n.disableAlpha?v("",!0):(t(),l("div",se,[u(w,{value:e.colors,"onUpdate:value":a[2]||(a[2]=a=>e.colors=a),onChange:m.childChange},null,8,["value","onChange"])]))])]),n.disableFields?v("",!0):(t(),l("div",ne,[s(o("div",oe,[o("div",ie,[u(x,{label:"r",value:e.colors.rgba.r,onChange:m.inputChange},null,8,["value","onChange"])]),o("div",re,[u(x,{label:"g",value:e.colors.rgba.g,onChange:m.inputChange},null,8,["value","onChange"])]),o("div",he,[u(x,{label:"b",value:e.colors.rgba.b,onChange:m.inputChange},null,8,["value","onChange"])]),n.disableAlpha?v("",!0):(t(),l("div",ce,[u(x,{label:"a",value:e.colors.a,"arrow-offset":.01,max:1,onChange:m.inputChange},null,8,["value","arrow-offset","onChange"])]))],512),[[g,1===p.fieldsIndex]])]))])],2)}]]);const de={class:"vc-chrome-field custom"},ve={class:"vc-chrome-field custom"},ge={class:"vc-chrome-field custom"},pe={class:"vc-chrome-field custom"},me={class:"vc-chrome-field"},be={class:"vc-color-view"},fe=p({__name:"GColorPicker",props:{value:String},emits:["change"],setup(e,{emit:a}){const s=e,{prefixCls:n}=m("g-color-picker"),i=/rgba\((\d{1,3}), ?(\d{1,3}), ?(\d{1,3}), ?([10]?\.?\d+)\)/,c={r:0,g:0,b:0,a:1},d=b({rgba:c}),v=f((()=>d.rgba)),g=C(L,100);function p(e){d.rgba=e.rgba,g()}function $(e,a){if(!e.target){for(let[a,t]of Object.entries(e)){let e=parseFloat(t);isNaN(e)&&(e=0),d.rgba[a]=e}g()}}function L(){let{r:e,g:t,b:l,a:s}=d.rgba;a("change",`rgba(${e}, ${t}, ${l}, ${s})`)}return w((()=>s.value),(e=>{if(e&&i.test(e)){let a=e.match(i);d.rgba.r=parseInt(a[1]),d.rgba.g=parseInt(a[2]),d.rgba.b=parseInt(a[3]),d.rgba.a=parseFloat(a[4])}else d.rgba=c,L()}),{immediate:!0}),(e,a)=>(t(),l("div",{class:h([x(n),"vc-chrome-fields"])},[o("div",de,[u(x(H),{label:"r",value:x(v).r,min:0,max:255,onChange:$},null,8,["value"])]),o("div",ve,[u(x(H),{label:"g",value:x(v).g,min:0,max:255,onChange:$},null,8,["value"])]),o("div",ge,[u(x(H),{label:"b",value:x(v).b,min:0,max:255,onChange:$},null,8,["value"])]),o("div",pe,[u(x(H),{label:"a",value:x(v).a,min:0,max:1,"arrow-offset":.01,onChange:$},null,8,["value","arrow-offset"])]),o("div",me,[u(x(k),{trigger:"click",placement:"bottom",getPopupContainer:e=>e.parentNode},{content:y((()=>[u(x(ue),{value:d,onInput:p},null,8,["value"])])),default:y((()=>[o("div",be,[o("div",{style:r(`height:100%;background:rgba(${x(v).r},${x(v).g},${x(v).b},${x(v).a})`)},null,4)])])),_:1},8,["getPopupContainer"])])],2))}});export{fe as default};
