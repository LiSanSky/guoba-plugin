import{a as e,b as a,r as l,eR as i,w as t,am as s,v as o,e as u,o as n,f as v,k as c,j as d,z as r,i as p,d0 as m,ca as b,x as h,F as f,h as g,bT as w,l as x,m as B,d$ as y,M as L,eS as k,cU as _,cV as C}from"./index.js";import M from"./IconUploader.js";const R=e=>(_("data-v-721f34ad"),e=e(),C(),e),j=[x(" 选择图标 "),R((()=>r("span",{class:"tip"},"按住这里可拖动",-1)))],S={class:"icon-view-wrap"},U={class:"icon-view"},$=["onClick"],I={class:"add-icon"};var z=e(a({__name:"SelectIconModal",props:{visible:Boolean,cell:Object,iconB64List:Array},emits:["update:visible"],setup(e,{emit:a}){const _=e,C=l(!1),R=l({show:!1,selected:null}),z=()=>{a("update:visible",!1)},A=()=>{C.value=!C.value,C.value&&k.info("请点击想要替换的图标")},T=l(null),{x:V,y:D,isDragging:F}=i(T),N=l(0),O=l(0),q=l(!1),E=l(0),G=l(0),H=l(0),J=l(0),K=l({left:0,right:0,top:0,bottom:0});t([V,D],(()=>{if(!q.value){N.value=V.value,O.value=D.value;const e=document.body.getBoundingClientRect(),a=T.value.getBoundingClientRect();K.value.right=e.width-a.width,K.value.bottom=e.height-a.height,H.value=E.value,J.value=G.value}q.value=!0})),t(F,(()=>{F||(q.value=!1)})),s((()=>{q.value&&(E.value=H.value+Math.min(Math.max(K.value.left,V.value),K.value.right)-N.value,G.value=J.value+Math.min(Math.max(K.value.top,D.value),K.value.bottom)-O.value)}));const P=o((()=>({transform:`translate(${E.value}px, ${G.value}px)`})));return(l,i)=>{const t=u("a-button");return n(),v(f,null,[c(h(L),{visible:e.visible,"onUpdate:visible":i[0]||(i[0]=e=>y(visible)?visible.value=e:null),onCancel:z,width:"460px",closable:!1,footer:null},{title:d((()=>[r("div",{ref_key:"modalTitleRef",ref:T,style:{width:"100%",cursor:"move"}},j,512)])),modalRender:d((({originVNode:e})=>[r("div",{style:b(h(P))},[(n(),p(m(e)))],4)])),default:d((()=>[r("div",S,[r("div",U,[(n(!0),v(f,null,g(new Array(100).toString().split(","),((l,i)=>(n(),v("div",{class:w(C.value?"edit-icon":"medium-icon"),style:b({background:`url(${e.iconB64List[i+1]}) 0 0 no-repeat`,backgroundSize:"50px 50px"}),onClick:e=>(e=>{C.value?(R.value.show=!0,R.value.selected=e+1):(_.cell.icon=e+1,a("update:visible",!1))})(i)},null,14,$)))),256)),r("div",I,[c(t,{type:C.value?"danger":"success",onClick:A},{default:d((()=>[x(B(C.value?"完成":"添加自定义图标"),1)])),_:1},8,["type"])])])])])),_:1},8,["visible"]),c(M,{uploader:R.value,iconB64List:e.iconB64List,"onUpdate:iconB64List":i[1]||(i[1]=e=>y(iconB64List)?iconB64List.value=e:null)},null,8,["uploader","iconB64List"])],64)}}}),[["__scopeId","data-v-721f34ad"]]);export{z as default};
