import{a as e,b as a,r as l,fU as t,w as i,J as s,R as o,e as u,o as n,f as v,l as r,k as c,D as d,i as p,ak as m,a2 as b,H as f,F as g,h,x as y,m as k,q as w,y as B,c3 as x,fV as L,fW as C,A as _,C as M,e9 as R}from"./index.js";import j from"./IconUploader.js";import"./esm.js";const A=e=>(_("data-v-3781abee"),e=e(),M(),e),S=[k(" 选择图标 "),A((()=>d("span",{class:"tip"},"按住这里可拖动",-1)))],U={class:"icon-view-wrap"},$={class:"icon-view"},D=["onClick"],I=k("添加10个空图标");var V=e(a({props:{visible:Boolean,cell:Object,iconB64List:Array},emits:["update:visible"],setup(e,{emit:a}){const _=e,{createMessage:M}=R(),A=l(!1),V=l({show:!1,selected:null}),q=()=>{a("update:visible",!1)},z=()=>{A.value=!A.value,A.value&&C.info("请点击想要替换的图标")},F=l(null),{x:H,y:J,isDragging:N}=t(F),O=l(0),T=l(0),W=l(!1),E=l(0),G=l(0),K=l(0),P=l(0),Q=l({left:0,right:0,top:0,bottom:0});i([H,J],(()=>{if(!W.value){O.value=H.value,T.value=J.value;const e=document.body.getBoundingClientRect(),a=F.value.getBoundingClientRect();Q.value.right=e.width-a.width,Q.value.bottom=e.height-a.height,K.value=E.value,P.value=G.value}W.value=!0})),i(N,(()=>{N||(W.value=!1)})),s((()=>{W.value&&(E.value=K.value+Math.min(Math.max(Q.value.left,H.value),Q.value.right)-O.value,G.value=P.value+Math.min(Math.max(Q.value.top,J.value),Q.value.bottom)-T.value)}));const X=o((()=>({transform:`translate(${E.value}px, ${G.value}px)`})));function Y(){let e=_.iconB64List,a=!1;for(let l=1;l<e.length;l++)if(!e[l]){a=!0;break}a?M.warn("仍有未利用的空白图标，无法继续添加"):e.push(...Array(10).fill(""))}return(l,t)=>{const i=u("a-button"),s=u("a-space");return n(),v(g,null,[r(f(L),B({visible:e.visible,"onUpdate:visible":t[0]||(t[0]=e=>x(visible)?visible.value=e:null),onCancel:q,width:"420px",closable:!1,footer:null,maskStyle:{background:"rgba(0, 0, 0, 0.1)"}},l.$attrs),{title:c((()=>[d("div",{ref_key:"modalTitleRef",ref:F,style:{width:"100%",cursor:"move"}},S,512)])),modalRender:c((({originVNode:e})=>[d("div",{style:b(f(X))},[(n(),p(m(e)))],4)])),default:c((()=>[d("div",U,[d("div",$,[(n(!0),v(g,null,h(new Array(e.iconB64List.length-1).toString().split(","),((l,t)=>(n(),v("div",{class:y(A.value?"edit-icon":"medium-icon"),style:b({background:`url(${e.iconB64List[t+1]}) 0 0 no-repeat`,backgroundSize:"50px 50px"}),onClick:e=>{return l=t,void(A.value?(V.value.show=!0,V.value.selected=l+1):(_.cell.icon=l+1,a("update:visible",!1)));var l}},null,14,D)))),256)),r(s,{class:"add-icon",style:{padding:"10px",width:"100%"}},{default:c((()=>[r(i,{type:A.value?"danger":"success",onClick:z},{default:c((()=>[k(w(A.value?"完成":"替换图标"),1)])),_:1},8,["type"]),r(i,{type:"primary",onClick:Y},{default:c((()=>[I])),_:1})])),_:1})])])])),_:1},16,["visible","maskStyle"]),r(j,{uploader:V.value,iconB64List:e.iconB64List,"onUpdate:iconB64List":t[1]||(t[1]=e=>x(iconB64List)?iconB64List.value=e:null)},null,8,["uploader","iconB64List"])],64)}}}),[["__scopeId","data-v-3781abee"]]);export{V as default};
