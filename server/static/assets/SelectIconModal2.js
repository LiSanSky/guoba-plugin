import{a as e,b as a,r as l,fT as i,w as t,al as s,v as o,e as u,o as n,f as v,k as c,j as r,z as d,i as p,d5 as m,c4 as b,x as f,F as h,h as g,bN as y,l as w,m as B,e3 as x,M as k,fU as L,bP as _,cV as C,cW as M}from"./index.js";import j from"./IconUploader2.js";import"./esm.js";const R=e=>(C("data-v-4c6a2dc7"),e=e(),M(),e),U=[w(" 选择图标 "),R((()=>d("span",{class:"tip"},"按住这里可拖动",-1)))],A={class:"icon-view-wrap"},I={class:"icon-view"},S=["onClick"],$=w("添加10个空图标");var z=e(a({__name:"SelectIconModal",props:{visible:Boolean,cell:Object,iconB64List:Array},emits:["update:visible"],setup(e,{emit:a}){const C=e,{createMessage:M}=_(),R=l(!1),z=l({show:!1,selected:null}),N=()=>{a("update:visible",!1)},T=()=>{R.value=!R.value,R.value&&L.info("请点击想要替换的图标")},V=l(null),{x:D,y:F,isDragging:O}=i(V),P=l(0),W=l(0),q=l(!1),E=l(0),G=l(0),H=l(0),J=l(0),K=l({left:0,right:0,top:0,bottom:0});t([D,F],(()=>{if(!q.value){P.value=D.value,W.value=F.value;const e=document.body.getBoundingClientRect(),a=V.value.getBoundingClientRect();K.value.right=e.width-a.width,K.value.bottom=e.height-a.height,H.value=E.value,J.value=G.value}q.value=!0})),t(O,(()=>{O||(q.value=!1)})),s((()=>{q.value&&(E.value=H.value+Math.min(Math.max(K.value.left,D.value),K.value.right)-P.value,G.value=J.value+Math.min(Math.max(K.value.top,F.value),K.value.bottom)-W.value)}));const Q=o((()=>({transform:`translate(${E.value}px, ${G.value}px)`})));function X(){let e=C.iconB64List,a=!1;for(let l=1;l<e.length;l++)if(!e[l]){a=!0;break}a?M.warn("仍有未利用的空白图标，无法继续添加"):e.push(...Array(10).fill(""))}return(l,i)=>{const t=u("a-button"),s=u("a-space");return n(),v(h,null,[c(f(k),{visible:e.visible,"onUpdate:visible":i[0]||(i[0]=e=>x(visible)?visible.value=e:null),onCancel:N,width:"420px",closable:!1,footer:null,mask:!1},{title:r((()=>[d("div",{ref_key:"modalTitleRef",ref:V,style:{width:"100%",cursor:"move"}},U,512)])),modalRender:r((({originVNode:e})=>[d("div",{style:b(f(Q))},[(n(),p(m(e)))],4)])),default:r((()=>[d("div",A,[d("div",I,[(n(!0),v(h,null,g(new Array(e.iconB64List.length-1).toString().split(","),((l,i)=>(n(),v("div",{class:y(R.value?"edit-icon":"medium-icon"),style:b({background:`url(${e.iconB64List[i+1]}) 0 0 no-repeat`,backgroundSize:"50px 50px"}),onClick:e=>{return l=i,void(R.value?(z.value.show=!0,z.value.selected=l+1):(C.cell.icon=l+1,a("update:visible",!1)));var l}},null,14,S)))),256)),c(s,{class:"add-icon",style:{padding:"10px",width:"100%"}},{default:r((()=>[c(t,{type:R.value?"danger":"success",onClick:T},{default:r((()=>[w(B(R.value?"完成":"替换图标"),1)])),_:1},8,["type"]),c(t,{type:"primary",onClick:X},{default:r((()=>[$])),_:1})])),_:1})])])])),_:1},8,["visible"]),c(j,{uploader:z.value,iconB64List:e.iconB64List,"onUpdate:iconB64List":i[1]||(i[1]=e=>x(iconB64List)?iconB64List.value=e:null)},null,8,["uploader","iconB64List"])],64)}}}),[["__scopeId","data-v-4c6a2dc7"]]);export{z as default};
