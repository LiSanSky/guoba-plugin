var e=(e,a,o)=>new Promise(((i,t)=>{var n=e=>{try{l(o.next(e))}catch(a){t(a)}},s=e=>{try{l(o.throw(e))}catch(a){t(a)}},l=e=>e.done?i(e.value):Promise.resolve(e.value).then(n,s);l((o=o.apply(e,a)).next())}));import{a,b as o,bK as i,r as t,c as n,e as s,o as l,i as r,j as p,k as m,z as d,bO as u,bc as c,bN as j,bP as g}from"./index.js";import{P as f}from"./index12.js";import B from"./MiaoHeader2.js";import v from"./HelpPanel2.js";import{B as h,s as x,g as y,a as b}from"./BackupDrawer2.js";import{u as k}from"./index28.js";import"./index14.js";import"./onMountedOrActivated.js";import"./useWindowSizeFn.js";import"./useContentViewHeight.js";import"./ArrowLeftOutlined.js";import"./transButton.js";import"./EditBodyModal2.js";import"./index5.js";import"./SelectIconModal2.js";import"./IconUploader2.js";import"./esm.js";import"./miao.api.js";import"./base64Conver.js";import"./index3.js";import"./FullscreenOutlined.js";import"./UploadIconHelpModal2.js";import"./21ae6624.js";import"./usePrompt.js";import"./Prompt.js";import"./BasicForm.js";import"./index2.js";import"./find.js";import"./_baseIteratee.js";import"./get.js";import"./index4.js";import"./useFormItem.js";import"./upperFirst.js";import"./download.js";import"./index6.js";import"./index7.js";import"./uniqBy.js";import"./useForm.js";import"./index9.js";const D=o({name:"MiaoPluginExtra",components:{HelpPanel:v,EditMiaoHeader:B,PageWrapper:f,BackupDrawer:h},setup(){const{prefixCls:a}=i("edit-miao-help"),{createMessage:o,createConfirm:s}=g(),l=t(!0),r=t(!0),p=t(0),m=t(null),d=t(null),u=t(null),c=t(null),j=t(null),f=n({miao:"x.x.x",yunzai:"x.x.x"}),B=t({show:!1,cell:null,cellIndex:null,group:null,groupIndex:null}),[v,{openDrawer:h}]=k(),D=()=>e(this,null,(function*(){try{r.value=!0;let e=yield y();m.value=e.helpCfg,d.value=e.helpList,f.miao=e.miaoVersion,f.yunzai=e.yunzaiVersion,u.value=null,c.value=null,j.value=yield b()}finally{r.value=!1,l.value=!1,p.value++}}));return D(),{prefixCls:a,loading:r,pageLoading:l,helpCfg:m,helpList:d,bgB64:u,mainB64:c,iconB64List:j,cacheVer:p,versions:f,modelData:B,onBackup:function(){h(!0,{})},onRollback:function(){s({title:"提示",iconType:"warning",content:"确定要放弃所有修改吗？",onOk:()=>{D()}})},loadData:D,saveData:()=>e(this,null,(function*(){try{r.value=!0,yield x(m,d,j,c),yield D(),o.success("保存成功~")}finally{r.value=!1}})),registerDrawer:v}}}),L={class:"flex justify-center md:pt-4 my-4"};var w=a(D,[["render",function(e,a,o,i,t,n){const g=s("EditMiaoHeader"),f=s("HelpPanel"),B=s("BackupDrawer"),v=s("PageWrapper");return l(),r(v,{class:j([e.prefixCls]),title:"编辑喵喵帮助",dense:"",sticky:"",stickyTop:"-14px",loading:e.loading},{headerContent:p((()=>[m(g,{onSave:e.saveData,onRollback:e.onRollback,onBackup:e.onBackup},null,8,["onSave","onRollback","onBackup"])])),default:p((()=>[d("div",L,[m(c,{name:"scroll-y-reverse-transition"},{default:p((()=>[e.pageLoading?u("",!0):(l(),r(f,{key:0,cacheVer:e.cacheVer,versions:e.versions,helpCfg:e.helpCfg,"onUpdate:helpCfg":a[0]||(a[0]=a=>e.helpCfg=a),helpList:e.helpList,"onUpdate:helpList":a[1]||(a[1]=a=>e.helpList=a),bgB64:e.bgB64,"onUpdate:bgB64":a[2]||(a[2]=a=>e.bgB64=a),mainB64:e.mainB64,"onUpdate:mainB64":a[3]||(a[3]=a=>e.mainB64=a),iconB64List:e.iconB64List,"onUpdate:iconB64List":a[4]||(a[4]=a=>e.iconB64List=a),modelData:e.modelData,"onUpdate:modelData":a[5]||(a[5]=a=>e.modelData=a)},null,8,["cacheVer","versions","helpCfg","helpList","bgB64","mainB64","iconB64List","modelData"]))])),_:1})]),m(B,{onRegister:e.registerDrawer,onReload:e.loadData},null,8,["onRegister","onReload"])])),_:1},8,["class","loading"])}]]);export{w as default};
